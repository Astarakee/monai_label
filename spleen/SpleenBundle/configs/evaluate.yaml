imports:
- $import torch
- $import scripts
- $import scripts.network
- $import scripts.loader
- $import scripts.tools
- $import scripts.evaluate


network:
  _target_: scripts.network.UNET

train_val_files: '$scripts.loader.get_files(@input_dir)'
val_files: '$@train_val_files["val_files"]'

val_org_transforms: '$scripts.tools.orig_space_transform(@a_min, @a_max, @voxel_space1, @voxel_space2, @voxel_space3)'
val_org_ds:
  _target_: Dataset
  data: '@val_files'
  transform: '@val_org_transforms'

val_org_loader:
  _target_: DataLoader
  dataset: '@val_org_ds'
  batch_size: '@batch_val'
  num_workers: '@n_worker'

post_transforms: '$scripts.tools.get_post_transform(@val_org_transforms)'
evaluator: '$scripts.evaluate.evaluation(@abs_path_checkpoint, @device, @network, @val_org_loader, @iso_patch_size_val, @sw_batch_size, @post_transforms)'